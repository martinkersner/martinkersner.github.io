<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Martin Keršner's blog - Machine Learning and Computer Vision</title>
    <meta name="description" content="Machine Learning, Computer Vision" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="post-template">

    <header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="back-button icon-arrow-left" href="/">Home</a>
        <!--<a class="subscribe-button icon-feed" href="/rss.xml">Subscribe</a>-->
    </nav>
</header>

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Faster grep</h1>
            <section class="post-meta">                
                <time class="post-date" datetime="2016-04-11">11 Apr 2016</time>
                 
                    on Linux and grep 
                
            </section>
        </header>

<!--         <header class="post-header">
            <a id="blog-logo" href="http://martinkersner.github.io">
                
                    <span class="blog-title">Martin Keršner's blog</span>
                 
            </a>
        </header> -->
        
        <!-- <span class="post-meta">
            <time datetime="2016-04-11">11 Apr 2016</time>
             
                on Linux and grep 
            
        </span> -->

        <!-- <h1 class="post-title">Faster grep</h1> -->

        <section class="post-content">
            <p>Grep is GNU tool that is used for matching lines with particular pattern.
In most cases it is remarkably fast but sometimes it is better to use explicit implementation mimicking grep&#39;s functionality.</p>

<p>If one wants to search for not only one pattern, grep&#39;s option <em>-f</em> allows to specify file containing arbitrary number of patterns, one per line.
Following command searches for patterns from <em>patterns.txt</em> in <em>file.txt</em>.
Lines that are matched with any pattern are printed into standard output.</p>

<p><code>bash
grep -f patterns.txt file.txt
</code></p>

<p>GNU grep&#39;s approach of matching is general but sometimes at the expense of speed.
Uderstanding of data and details of file we work with can speed up our pattern matching.</p>

<h2>Example</h2>

<p>Let&#39;s say that we have a file with paths to images but we want to obtain just some of them.</p>

<p><em>file.txt</em>
<code>
/images_aug/2008_000002.jpg /labels_bbox/2008_000002.png
/images_aug/2008_000003.jpg /labels_bbox/2008_000003.png
/images_aug/2008_000007.jpg /labels_bbox/2008_000007.png
...
</code></p>

<p>We also have a file with patterns (file names of images) that we want to include in result.</p>

<p><em>patterns.txt</em>
<code>
2007_000032.png
2007_000039.png
2007_000063.png
...
</code></p>

<p>In both files we assume that every line is unique and lines are sorted.
Without uniqueness this particualar example wouldn&#39;t make sense.
Sorting lines is one of the secrets allowing much faster pattern matching, therefore sorted lines are necessary.
If we use GNU grep lines don&#39;t have to be sorted but sorting itself doesn&#39;t affect overall speed of pattern matching because we can sort files just ones.
Sorting (GNU sort) file  with 11,355 lines takes about 0.080 seconds and that is insignificant in comparison with the time spent for pattern matching. </p>

<script src="https://gist.github.com/martinkersner/32e909a518d6983d37b524a4d3984dd4.js"></script>

<h2>Evaluation</h2>

<p>In order to compare GNU grep and faster grep I used different number (100; 500; 2,500; 5,000 and 10,000) of patterns.
Patterns where searched in file with 11,355 lines.
Plot below depicts times spent for pattern matching of both methods.</p>

<p><img src="http://i.imgur.com/qtW8mcR.png?1" align="center"/></p>

<p>GNU grep seems to perform faster when number of patterns is lower but with higher number of patterns time spent with matching dramatically increases.
Faster grep is significantly faster when number of patterns is rather high.</p>

        </section>

        

        <footer class="post-footer">
            <!-- If we want to display author's name and bio -->
            
                <figure class="author-image">
                    <a class="img" href="/" style="background-image: url(/assets/images/profile.png)">
                    <span class="hidden">Martin Keršner's Picture</span></a>
                </figure>
                <section class="author">
                    <!-- Author Name -->
                    <h4> Martin Keršner </h4>
                    <!-- Author Bio -->
                    <p> 
                        Machine learning engineer in Company 100, Seoul, South Korea.
                    </p>
                </section>                
            

            <!-- Share links section -->
            <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" href="http://twitter.com/share?text=Faster grep&amp;url=http://martinkersner.github.io/Linux/grep/2016/04/11/Faster-grep.html"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://martinkersner.github.io/Linux/grep/2016/04/11/Faster-grep.html"
        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://martinkersner.github.io/Linux/grep/2016/04/11/Faster-grep.html"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>
            
            <!-- Disqus comments -->
            
            
        </footer>

    </article>

</main>

    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="/">Martin Keršner's blog</a> &copy; 
               &bull; All rights reserved.
      </section>
    </footer>
    
    <script type="text/javascript" src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-69668159-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>   
</body>
</html>
